<!DOCTYPE html>
<html>
<header>
  <meta charset="utf-8" />
  <title>DoodleChamp lobby</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
</header>

<body>
  <h2>Join code: {{ room_name }}</h2>

  {{ room_name|json_script:"room-name" }}
  <div class="container text-center">
    <div class="row">
      <div id="player-list" class="col border">
        Player List
      </div>
      <div class="col border">
        Settings
      </div>
    </div>
  </div><br>
  <br><br>
  
  <form action="Game" method = "POST">
    <input type="hidden" value="{{ room_name }}" name="game-code">
    
    <button id="start-btn">Start Game</button><br><br>
    {% csrf_token %}
  </form>

<<<<<<< HEAD
          chatSocket.onmessage = function(e) {
              const data = JSON.parse(e.data);
              let playerList = document.getElementById("player-list");
              ptag = document.createElement('p');
                    ptag.innerHTML = data.player;
                    playerList.appendChild(ptag);
          };
          chatSocket.onopen = function(e){
            chatSocket.send(JSON.stringify({
              "type": "websocket.connect",
              "player": "{{username}}"
            }))
          }
          chatSocket.onclose = function(e) {
              console.error('Chat socket closed unexpectedly');
          };
=======
  <script>

    document.querySelector('#start-btn').onclick = function(e){
      let gameCode = '{{ room_name }}';
      console.log(gameCode)
      window.location.pathname = '/DoodleChamp/' + gameCode + '/';
    }

    // document.querySelector('#game-code').onkeyup = function(e) {
    //     if (e.keyCode === 13) { // enter, return
    //         document.querySelector('#start-btn').click();
    //     }
    // }
    const roomName = JSON.parse(document.getElementById('room-name').textContent);

    const chatSocket = new WebSocket(
      'ws://'
      + window.location.host
      + '/ws/DoodleChamp/'
      + roomName
      + '/'
    );

    chatSocket.onmessage = function (e) {
      const data = JSON.parse(e.data);
      let playerList = document.getElementById("player-list")
      ptag = document.createElement('div');
      ptag.innerHTML = data.player;
      playerList.appendChild(ptag);
    };
    chatSocket.onopen = function (e) {
      chatSocket.send(JSON.stringify({
        'player': "player1"
      }))
    }
    chatSocket.onclose = function (e) {
      console.error('Chat socket closed unexpectedly');
    };
>>>>>>> 521bca7f7669979614431704a6c464a2e5b4f69f


          // document.querySelector('#chat-message-input').focus();
          // document.querySelector('#chat-message-input').onkeyup = function(e) {
          //     if (e.keyCode === 13) { // enter, return
          //         document.querySelector('#chat-message-submit').click();
          //     }
          // }

          // document.querySelector('#chat-message-submit').onclick = function(e) {
          //     const messageInputDom = document.querySelector('#chat-message-input');
          //     const message = messageInputDom.value;
          //     chatSocket.send(JSON.stringify({
          //         'message': message
          //     }))
          //     messageInputDom.value = '';
          // };
  </script>
</body>

</html>